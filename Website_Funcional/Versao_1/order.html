<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>NutrilinEeste</title>
    <meta name="description" content="Entrega de comida saudável">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cabin:700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito+Sans">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="assets/css/-Login-form-Page-BS4-.css">
    <link rel="stylesheet" href="assets/css/Animated-Typing-With-Blinking.css">
    <link rel="stylesheet" href="assets/css/Bold-BS4-Footer-Small-Logo.css">
    <link rel="stylesheet" href="assets/css/Bootstrap-Cards-v2.css">
    <link rel="stylesheet" href="assets/css/Button-Outlines---Pretty.css">
    <link rel="stylesheet" href="assets/css/Card-Group-Classic-1.css">
    <link rel="stylesheet" href="assets/css/Card-Group-Classic.css">
    <link rel="stylesheet" href="assets/css/Login-Form-Dark.css">
    <link rel="stylesheet" href="assets/css/Multi-step-form.css">
    <link rel="stylesheet" href="assets/css/SIdebar-Responsive-2-1.css">
    <link rel="stylesheet" href="assets/css/SIdebar-Responsive-2.css">
    <link rel="stylesheet" href="assets/css/Studious-selectbox.css">
    <link rel="stylesheet" href="assets/css/Team-Boxed.css">
    <link rel="stylesheet" href="assets/css/Vertical-Left-SideBar-by-Jigar-Mistry.css">
</head>

<body style="background: rgb(255,255,255);">
    <nav class="navbar navbar-light navbar-expand-md navbar navbar-expand-lg fixed-top" id="mainNav" style="background: rgb(254,254,254);height: 74px;color: rgb(255,255,255);margin: 0px;margin-right: 0px;margin-left: 0px;position: relative;">
        <div class="container-fluid" style="margin:0px;"><a class="navbar-brand js-scroll-trigger" href="index_inner.html" style="color: rgb(17,108,2);">Nutrilink</a><button data-toggle="collapse" class="navbar-toggler navbar-toggler-right" data-target="#navbarResponsive" type="button" aria-controls="navbarResponsive"
                aria-expanded="false" aria-label="Toggle navigation" value="Menu"><i class="fa fa-bars"></i></button>
            <div class="collapse navbar-collapse" id="navbarResponsive" style="color: rgba(213,213,213,0);">
                <ul class="nav navbar-nav ml-auto">
                    <li class="nav-item nav-link js-scroll-trigger"><a class="nav-link js-scroll-trigger" href="index_inner.html" style="color: rgb(17,108,2);margin: px;margin-right: 0px;">Inicio</a></li> 
                    <li class="nav-item nav-link js-scroll-trigger"><a class="nav-link js-scroll-trigger" href="restaurantes.html" style="color: rgb(17,108,2);">Restaurantes</a></li>
                    <li class="nav-item nav-link js-scroll-trigger"><a class="nav-link js-scroll-trigger" href="settings.html" style="color: rgb(17,108,2);">Definições</a></li>
                    <li class="nav-item nav-link js-scroll-trigger"><a class="nav-link js-scroll-trigger" id="logout" href="login.html" style="color: rgb(17,108,2);">Logout</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <section>
        <div id="multple-step-form-n" class="container overflow-hidden" style="margin-top: 0px;margin-bottom: 10px;padding-bottom: 300px;padding-top: 57px;">
            <div id="progress-bar-button" class="multisteps-form">
                <div class="row">
                    <div class="col-12 col-lg-8 ml-auto mr-auto mb-4">
                        <div class="multisteps-form__progress"><a class="btn multisteps-form__progress-btn js-active" role="button" title="User Info">pedido</a><a class="btn multisteps-form__progress-btn" role="button" title="User Info">entrega/pagamento</a><a class="btn multisteps-form__progress-btn"
                                role="button" title="User Info" onclick="verifica()">Confirmação&nbsp;</a></div>
                    </div>
                </div>
            </div>
            <div id="multistep-start-row" class="row">
                <div id="multistep-start-column" class="col-12 col-lg-8 m-auto">
                    <form id="main-form" class="multisteps-form__form">
                        <div id="single-form-next" class="multisteps-form__panel shadow p-4 rounded bg-white js-active" data-animation="scaleIn">
                            <h3 class="text-center multisteps-form__title" style="color: black;">Pedido</h3>
                            <h3 class="text-center multisteps-form__title" style="color: black;font-size: 1rem;margin-bottom: 0px;" id="restau"></h3>
                            <hr>
                            <div id="form-content" class="multisteps-form__content">
                                <div class="items" id="items">
                                    <p class="text-black font-weight-bold">Resumo:</p>
                                    <p class="text-black itemsText"><span class="spanAmount">2x&nbsp;</span>Esparguete Cozido - 10€</p>
                                    <p class="text-black itemsText"><span class="spanAmount">2x&nbsp;</span>Esparguete Cozido - 10€</p>
                                    <p class="text-black font-weight-light itemsText">Taxa de entrega - 1€</p>
                                    <p class="text-black font-weight-bold itemsText">Total: 41€</p>
                                    <hr>
                                </div>
                                <div id="next-button" class="button-row d-flex mt-4"><button class="btn btn btn-primary ml-auto js-btn-next" type="button" title="Next" style="background: #83ad47;border-color: #83ad47;"><i class="fa fa-chevron-right js-btn-next"></i></button></div>
                            </div>
                        </div>
                        <div id="single-form-next-prev" class="multisteps-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                            <hr>
                            <h3 class="text-center multisteps-form__title" style="font-size: 1.5rem;color: black;">Entrega</h3>
                            <div id="form-content-1" class="multisteps-form__content">
                                <div id="entrega" class="outl">
                                    <div class="selectbox">
                                        <div role="tablist" id="accordion-2" class="accordion accordion-select1">
                                            <div class="card">
                                                <div class="card-header" role="tab">
                                                    <!---Meter aki o default que e o primeiro-->
                                                    <h5 class="mb-0"><a data-toggle="collapse" aria-expanded="false" aria-controls="accordion-2 .item-1" href="#accordion-2 .item-1" class="selectbox-title1 collapsed" style="font-family: Cabin,Helvetica Neue,Helvetica,Arial,sans-serif;" id="endre">Endereço de entrega<i class="fa fa-star fa-angle-down"></i></a></h5>
                                                </div>
                                                <div class="collapse item-1" role="tabpanel" data-parent="#accordion-2">
                                                    <div class="card-body">
                                                        <ul class="testeDrop">
                                                            
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="text-black font-weight-normal text-center" style="margin-bottom: 2%;">&nbsp;Endereço:</p>
                                    <div id="endrInfo" class="borferline" style="margin-bottom: 5%;">
                                        <!---atualizar coforme-->
                                        <p class="text-black font-weight-normal text-add"></p>
                                    </div>
                                </div>
                                <hr>
                                <h3 class="text-center multisteps-form__title" style="font-size: 1.5rem;color: black;">Pagamento</h3>
                                <div id="entrega-1" class="outl" style="margin-bottom: 5%;">
                                    <div class="selectbox">
                                        <div role="tablist" id="accordion-1" class="accordion accordion-select">
                                            <div class="card">
                                                <div class="card-header" role="tab">
                                                    <!---Meter aki o default que e o primeiro-->
                                                    <h5 class="mb-0"><a data-toggle="collapse" aria-expanded="false" aria-controls="accordion-1 .item-1" href="#accordion-1 .item-1" class="selectbox-title collapsed" style="font-family: Cabin,Helvetica Neue,Helvetica,Arial,sans-serif;" id="carta">Cartão para pagamento<i class="fa fa-star fa-angle-down"></i></a></h5>
                                                </div>
                                                <div class="collapse item-1" role="tabpanel" data-parent="#accordion-1">
                                                    <div class="card-body">
                                                        <ul id="cartaoList">
                                                           
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="next-prev-buttons-1" class="button-row d-flex mt-4"><button class="btn btn btn-primary js-btn-prev" type="button" title="Prev" style="background: #83ad47;border-color: #83ad47;"><i class="fa fa-chevron-left js-btn-prev"></i></button><button class="btn btn btn-primary ml-auto js-btn-next" onclick="verifica()" type="button" title="Next"
                                    style="background: #83ad47;border-color: #83ad47;"><i class="fa fa-chevron-right js-btn-next" onclick="verifica()"></button></div>
                            </div>
                        </div>
                        <div id="single-form-next-prev-1" class="multisteps-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                            <h3 class="text-center multisteps-form__title" style="color: black;">Confirmação</h3>
                            <div id="form-content-2" class="multisteps-form__content">
                                <div class="items" id="finalItems">
                                    <p class="text-black font-weight-bold">Resumo:</p>
                                    <hr>
                                    <p class="text-black itemsText"><span class="spanAmount">2x&nbsp;</span>Esparguete Cozido - 10€</p>
                                    <p class="text-black itemsText"><span class="spanAmount">2x&nbsp;</span>Esparguete Cozido - 10€</p>
                                    <p class="text-black font-weight-light itemsText">Taxa de entrega - 1€</p>
                                    <p class="text-black font-weight-bold itemsText">Total: 41€</p>
                                    <hr>
                                    <p class="text-black font-weight-bold">Endereço:</p>
                                    <p class="text-black font-weight-light itemsText">&nbsp;Rua Ferreiras de baixo nsei que nseio que mais</p>
                                    <hr>
                                    <p class="text-black font-weight-bold">Pagamento:</p>
                                    <p class="text-black font-weight-light itemsText">&nbsp;Cartão X, ****-9827</p>
                                </div>
                                <div id="next-prev-buttons-1" class="button-row d-flex mt-4"><button class="btn btn btn-primary js-btn-prev" type="button" title="Prev" style="background: #83ad47;border-color: #83ad47;" ><i class="fa fa-chevron-left js-btn-prev"></i></button><button class="btn btn btn-primary ml-auto js-btn-next" type="button" title="Next"
                                    style="background: #83ad47;border-color: #83ad47;" id="sendOrder"><i class="fa fa-chevron-right js-btn-next"></button></div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <!-- Modal -->
    <div class="modal fade text-center" id="ItemModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body">
                <p class="text-black" style="font-weight: bold;font-size: 1.5rem;">Obrigado!</p>
                <p class="text-black" style="font-size: 1rem;">O seu pedido está a ser preparado, assim que o estafeta estiver no local, será contactado via telemóvel.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="location.href='index_inner.html';" data-dismiss="modal">Fechar</button>
            </div>
        </div>
        </div>
    </div>
    <!------>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <script>
        $('#logout').click(function(){
            document.cookie = "token=; path=/"
        })
    </script>
    <script>
        function template1(nome){
            return `<li><a class="selectbox-link1" href="#" style="color: black;">`+nome+`<span></span></a></li>`
        }
        function template2(rua,cidade,estado,codPos,pais){
            return `<p class="text-black font-weight-normal text-add">`+rua+`, `+estado+`, `+cidade+`<br>`+codPos+` , `+pais+`</p>`
        }
        function template3(nome,cartLast4){
            return `<li><a class="selectbox-link" href="#" style="color: black;">`+nome+`<span>****-`+cartLast4+`</span></a></li>`
        }
        //infoEndr = {}
        $('#endre').click(function(){
            nome = document.getElementById('endre').textContent
            document.getElementById('endrInfo').innerHTML = infoEndr[nome]
        })
        $('#sendOrder').click(function(){
            $.ajax({
                url: "http://websiteams.ddns.net:8080/sendPedido",
                type: "POST",
                xhrFields: {
                    withCredentials: true
                },
                data:{
                    info: document.getElementById('finalItems').innerHTML,
                    rest: localStorage.getItem('Rest'),
                },
                success:function(response) {
                    $('#ItemModal').modal('show');
                },
                error:function(){
                    alert("Algum campo do registo encontra-se incorreto!")
                }
            });
        })
        $(document).ready(function(){
            document.getElementById('restau').innerHTML = localStorage.getItem('Rest');
            $.ajax({
                url: "http://websiteams.ddns.net:8080/getCardsAndAddr",
                type: "GET",
                xhrFields: {
                    withCredentials: true
                },
                success:function(response) {
                    info = JSON.parse(response)
                    console.log(info)
                    document.getElementById('endre').innerHTML = info[0][0][2] + `<i class="fa fa-star fa-angle-down"></i>`
                    infoEndr = {}
                    for(i in info[0]){
                        document.getElementsByClassName('testeDrop')[0].innerHTML += template1(info[0][i][2])
                        infoEndr[info[0][i][2]] = template2(info[0][i][7],info[0][i][4],info[0][i][6],info[0][i][3],info[0][i][5])
                    }
                    for(i in info[1]){
                        card = info[1][i][3].toString().slice(12, 15)
                        document.getElementById('cartaoList').innerHTML += template3(info[1][i][2],card)
                    }
                    document.getElementById('carta').innerHTML = info[1][0][2] + `<i class="fa fa-star fa-angle-down"></i>`
                    nome = document.getElementById('endre').textContent
                    document.getElementById('endrInfo').innerHTML = infoEndr[nome]
                    $.getScript("assets/js/Studious-selectbox.js", function(){
                        
                    });
                    //
                },
                error:function(){
                    alert("O seu login expirou!")
                    window.location.href = "login.html";
                }
            });
        });
    </script>
    <script src="assets/js/grayscale.js"></script>
    <script src="assets/js/Animated-Typing-With-Blinking.js"></script>
    <script src="assets/js/Multi-step-form.js"></script>
    <script src="assets/js/order.js?v=2"></script>
</body>

</html>